node {
    
    def maven = tool name: "maven3.9"
   def remoteserver = "test1@3.85.238.114"
   def warfile = ""
   def remotePath = ""

     //checkout stage
    stage ('checkout'){
        git 'https://github.com/neetur427/nexustest.git'

    }
    //build stage
    stage ('building'){
        sh "$maven/bin/mvn clean package"
}
    //sonarqube report
    stage ('sonarqube report'){
        sh "$maven/bin/mvn sonar:sonar"
    }
    
    //nexus upload
    stage ('nexus upload'){
        sh "$maven/bin/mvn deploy"
    }
//deploy to tomcat
stage('deploy to tomcat'){
sshagent(['test1']) {
sh "scp $(warfile) $(remoteServer):$(remotePath)"
   }
}
}//node closing
